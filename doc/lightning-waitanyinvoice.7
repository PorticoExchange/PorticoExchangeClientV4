.\" -*- mode: troff; coding: utf-8 -*-
.TH "LIGHTNING-WAITANYINVOICE" "7" "" "Core Lightning 0.12.1" ""
.SH
NAME
.LP
lightning-waitanyinvoice -- Command for waiting for payments
.SH
SYNOPSIS
.LP
\fBwaitanyinvoice\fR [\fIlastpay_index\fR] [\fItimeout\fR]
.SH
DESCRIPTION
.LP
The \fBwaitanyinvoice\fR RPC command waits until an invoice is paid, then
returns a single entry as per \fBlistinvoice\fR. It will not return for
any invoices paid prior to or including the \fIlastpay_index\fR.
.PP
This is usually called iteratively: once with no arguments, then
repeatedly with the returned \fIpay_index\fR entry. This ensures that no
paid invoice is missed.
.PP
The \fIpay_index\fR is a monotonically-increasing number assigned to an
invoice when it gets paid. The first valid \fIpay_index\fR is 1; specifying
\fIlastpay_index\fR of 0 equivalent to not specifying a \fIlastpay_index\fR.
Negative \fIlastpay_index\fR is invalid.
.PP
If \fItimeout\fR is specified, wait at most that number of seconds, which
must be an integer.
If the specified \fItimeout\fR is reached, this command will return with an
error.
You can specify this to 0 so that \fBwaitanyinvoice\fR will return
immediately with an error if no pending invoice is available yet.
If unspecified, this command will wait indefinitely.
.SH
RETURN VALUE
.LP
On success, an object is returned, containing:
.IP "\(bu" 2
\fBlabel\fR (string): unique label supplied at invoice creation
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBdescription\fR (string): description used in the invoice
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBpayment_hash\fR (hash): the hash of the \fIpayment_preimage\fR which will prove payment (always 64 characters)
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBstatus\fR (string): Whether it's paid or expired (one of \(dqpaid\(dq, \(dqexpired\(dq)
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBexpires_at\fR (u64): UNIX timestamp of when it will become / became unpayable
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBamount_msat\fR (msat, optional): the amount required to pay this invoice
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBbolt11\fR (string, optional): the BOLT11 string (always present unless \fIbolt12\fR is)
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBbolt12\fR (string, optional): the BOLT12 string (always present unless \fIbolt11\fR is)
.LP
If \fBstatus\fR is \(dqpaid\(dq:
.IP "\(bu" 2
\fBpay_index\fR (u64): Unique incrementing index for this payment
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBamount_received_msat\fR (msat): the amount actually received (could be slightly greater than \fIamount_msat\fR, since clients may overpay)
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBpaid_at\fR (u64): UNIX timestamp of when it was paid
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBpayment_preimage\fR (secret): proof of payment (always 64 characters)
.LP
Possible errors are:
.IP "\(bu" 2
904.
The \fItimeout\fR was reached without an invoice being paid.
.SH
AUTHOR
.LP
Rusty Russell <\fIrusty@rustcorp.com.au\fR> is mainly responsible.
.SH
SEE ALSO
.LP
lightning-waitinvoice(7), lightning-listinvoice(7),
lightning-delinvoice(7), lightning-invoice(7).
.SH
RESOURCES
.LP
Main web site: \fIhttps://github.com/ElementsProject/lightning\fR
\" SHA256STAMP:df7807a2e06377c0453470f21a3fab441e937c0c8efe51f9c226e7b74a0662c9
