.\" -*- mode: troff; coding: utf-8 -*-
.TH "LIGHTNING-INVOICE" "7" "" "Core Lightning 0.12.1" ""
.SH
NAME
.LP
lightning-invoice -- Command for accepting payments
.SH
SYNOPSIS
.LP
\fBinvoice\fR \fIamount_msat\fR \fIlabel\fR \fIdescription\fR [\fIexpiry\fR]
[\fIfallbacks\fR] [\fIpreimage\fR] [\fIexposeprivatechannels\fR] [\fIcltv\fR] [\fIdeschashonly\fR]
.SH
DESCRIPTION
.LP
The \fBinvoice\fR RPC command creates the expectation of a payment of a
given amount of milli-satoshi: it returns a unique token which another
lightning daemon can use to pay this invoice. This token includes a
\fIroute hint\fR description of an incoming channel with capacity to pay the
invoice, if any exists.
.PP
The \fIamount_msat\fR parameter can be the string \(dqany\(dq, which creates an
invoice that can be paid with any amount. Otherwise it is a positive value in
millisatoshi precision; it can be a whole number, or a whole number
ending in \fImsat\fR or \fIsat\fR, or a number with three decimal places ending
in \fIsat\fR, or a number with 1 to 11 decimal places ending in \fIbtc\fR.
.PP
The \fIlabel\fR must be a unique string or number (which is treated as a
string, so \(dq01\(dq is different from \(dq1\(dq); it is never revealed to other
nodes on the lightning network, but it can be used to query the status
of this invoice.
.PP
The \fIdescription\fR is a short description of purpose of payment, e.g. \fI1
cup of coffee\fR. This value is encoded into the BOLT11 invoice and is
viewable by any node you send this invoice to (unless \fIdeschashonly\fR is
true as described below). It must be UTF-8, and cannot use \fI\eu\fR JSON 
escape codes.
.PP
The \fIexpiry\fR is optionally the time the invoice is valid for, in seconds.
If no value is provided the default of 604800 (1 week) is used.
.PP
The \fIfallbacks\fR array is one or more fallback addresses to include in
the invoice (in order from most-preferred to least): note that these
arrays are not currently tracked to fulfill the invoice.
.PP
The \fIpreimage\fR is a 64-digit hex string to be used as payment preimage
for the created invoice. By default, if unspecified, lightningd will
generate a secure pseudorandom preimage seeded from an appropriate
entropy source on your system. \fBIMPORTANT\fR: if you specify the
\fIpreimage\fR, you are responsible, to ensure appropriate care for
generating using a secure pseudorandom generator seeded with sufficient
entropy, and keeping the preimage secret. This parameter is an advanced
feature intended for use with cutting-edge cryptographic protocols and
should not be used unless explicitly needed.
.PP
If specified, \fIexposeprivatechannels\fR overrides the default route hint
logic, which will use unpublished channels only if there are no
published channels. If \fItrue\fR unpublished channels are always considered
as a route hint candidate; if \fIfalse\fR, never.  If it is a short channel id
(e.g. \fI1x1x3\fR) or array of short channel ids (or a remote alias), only those specific channels
will be considered candidates, even if they are public or dead-ends.
.PP
The route hint is selected from the set of incoming channels of which:
peer's balance minus their reserves is at least \fImsatoshi\fR, state is
normal, the peer is connected and not a dead end (i.e. has at least one
other public channel). The selection uses some randomness to prevent
probing, but favors channels that become more balanced after the
payment.
.PP
If specified, \fIcltv\fR sets the \fImin\fIfinal\fIcltv_expiry\fR for the invoice.
Otherwise, it's set to the parameter \fBcltv-final\fR.
.PP
If \fIdeschashonly\fR is true (default false), then the bolt11 returned
contains a hash of the \fIdescription\fR, rather than the \fIdescription\fR
itself: this allows much longer descriptions, but they must be
communicated via some other mechanism.
.SH
RETURN VALUE
.LP
On success, an object is returned, containing:
.IP "\(bu" 2
\fBbolt11\fR (string): the bolt11 string
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBpayment_hash\fR (hash): the hash of the \fIpayment_preimage\fR which will prove payment (always 64 characters)
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBpayment_secret\fR (secret): the \fIpayment_secret\fR to place in the onion (always 64 characters)
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBexpires_at\fR (u64): UNIX timestamp of when invoice expires
.LP
The following warnings may also be returned:
.IP "\(bu" 2
\fBwarning_capacity\fR: even using all possible channels, there's not enough incoming capacity to pay this invoice.
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBwarning_offline\fR: there would be enough incoming capacity, but some channels are offline, so there isn't.
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBwarning_deadends\fR: there would be enough incoming capacity, but some channels are dead-ends (no other public channels from those peers), so there isn't.
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBwarning_private_unused\fR: there would be enough incoming capacity, but some channels are unannounced and \fIexposeprivatechannels\fR is \fIfalse\fR, so there isn't.
.if n \
.sp -1
.if t \
.sp -0.25v
.IP "\(bu" 2
\fBwarning_mpp\fR: there is sufficient capacity, but not in a single channel, so the payer will have to use multi-part payments.
.LP
On failure, an error is returned and no invoice is created. If the
lightning process fails before responding, the caller should use
lightning-listinvoices(7) to query whether this invoice was created or
not.
.PP
The following error codes may occur:
- -1: Catchall nonspecific error.
- 900: An invoice with the given \fIlabel\fR already exists.
- 901: An invoice with the given \fIpreimage\fR already exists.
- 902: None of the specified \fIexposeprivatechannels\fR were usable.
.SH
AUTHOR
.LP
Rusty Russell <\fIrusty@rustcorp.com.au\fR> is mainly responsible.
.SH
SEE ALSO
.LP
lightning-listinvoices(7), lightning-delinvoice(7), lightning-pay(7).
.SH
RESOURCES
.LP
Main web site: \fIhttps://github.com/ElementsProject/lightning\fR
\" SHA256STAMP:1b18289fa0cb5d756fb1ba5ad30762e183c2e38e30e017c220be72d8b56646c1
